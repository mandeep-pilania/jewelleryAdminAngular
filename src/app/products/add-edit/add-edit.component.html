<section class="p-0">
  <div class="row">
    <!-- Header -->
    <div
      class="col-lg-12 d-flex justify-content-between align-Meterial-center mb-3"
    >
      <h5>üíç Add Product</h5>
      <button class="btn btn-primary" (click)="onBack()">‚Üê Back</button>
    </div>

    <!-- Form -->
    <div class="col-lg-12">
      <div class="table-responsive p-4 rounded shadow-sm bg-white">
        <form [formGroup]="productForm" class="row g-3">
          <!-- Product Name -->
          <div class="col-md-6 mb-3">
            <label class="form-label">Product Name</label>
            <input
              type="text"
              class="form-control"
              formControlName="ProductName"
              placeholder="Enter product name"
              [class.is-invalid]="
                V['ProductName'].invalid && (V['ProductName'].dirty || V['ProductName'].touched)
              "
            />
            <div
              class="invalid-feedback fixed-feedback"
              *ngIf="
                V['ProductName'].invalid && (V['ProductName'].dirty || V['ProductName'].touched)
              "
            >
              Product Name is required.
            </div>
          </div>

          <!-- Price -->
          <div class="col-md-6 mb-3">
            <label class="form-label">Price (‚Çπ)</label>
            <input
              type="number"
              class="form-control"
              formControlName="Price"
              placeholder="Enter Price"
              [class.is-invalid]="
                V['Price'].invalid && (V['Price'].dirty || V['Price'].touched)
              "
            />
            <div
              class="invalid-feedback fixed-feedback"
              *ngIf="
                V['Price'].invalid && (V['Price'].dirty || V['Price'].touched)
              "
            >
              Price must be greater than 0.
            </div>
          </div>

          <!-- Weight -->
          <div class="col-md-6 mb-3">
            <label class="form-label">Gross Weight (g)</label>
            <input
              type="number"
              class="form-control"
              formControlName="GrossWeight"
              placeholder="Enter Gross Weight"
              [class.is-invalid]="
                V['GrossWeight'].invalid &&
                (V['GrossWeight'].dirty || V['GrossWeight'].touched)
              "
            />
            <div
              class="invalid-feedback fixed-feedback"
              *ngIf="
                V['GrossWeight'].invalid &&
                (V['GrossWeight'].dirty || V['GrossWeight'].touched)
              "
            >
              Gross Weight must be at least 0.1g.
            </div>
          </div>

          <!-- Product Meterial Box -->
          <div class="col-12">
            <div class="form-array-box mt-3 p-3">
              <h6 class="mb-3">üì¶ Product Meterial</h6>
              <div formArrayName="Meterial">
                <div
                  class="row mb-3 align-Meterial-end"
                  *ngFor="let group of Meterial.controls; let i = index"
                  [formGroupName]="i"
                >
                  <!-- Category Dropdown -->
                  <div class="col-md-4">
                    <label>Category</label>
                    <select
                      class="form-control"
                      formControlName="CategoryID"
                      (change)="ChangeCategory($event)"
                      [class.is-invalid]="
                        group.get('CategoryID')?.invalid &&
                        group.get('CategoryID')?.touched
                      "
                    >
                      <option value="" disabled selected>
                        Select category
                      </option>
                      <option *ngFor="let item of AllCategories" [value]="item?.categoryID">
                        {{ item?.categoryName }}
                      </option>
                    </select>
                    <div class="invalid-feedback">Category required</div>
                  </div>

                  <!-- Subcategory Dropdown -->
                  <div class="col-md-4">
                    <label>Subcategory</label>
                    <select
                      class="form-control"
                      formControlName="SubCategoryID"
                      [class.is-invalid]="
                        group.get('SubCategoryID')?.invalid &&
                        group.get('SubCategoryID')?.touched
                      "
                    >
                      <option value="" disabled selected>
                        Select subcategory
                      </option>
                      <option *ngFor="let item of AllSubCategories" [value]="item?.subCategoryID">
                        {{ item?.subCategoryName }}
                      </option>
                    </select>
                    <div class="invalid-feedback">Subcategory required</div>
                  </div>

                  <!-- Quantity -->
                  <div class="col-md-3">
                    <label>Weight(g)</label>
                    <input
                      type="number"
                      class="form-control"
                      formControlName="Weight"
                      placeholder="Enter weight"
                      [class.is-invalid]="
                        group.get('Weight')?.invalid &&
                        group.get('Weight')?.touched
                      "
                    />
                    <div class="invalid-feedback">Weight min 0.1(g)</div>
                  </div>

                  <!-- Remove Button -->
                  <div class="col-md-1 text-center remove-btn-col">
                    <button
                      type="button"
                      class="btn btn-danger btn-sm remove-btn"
                      (click)="removeItem(i)"
                      [disabled]="Meterial.length === 1"
                    >
                      ‚úñ
                    </button>
                  </div>
                </div>
              </div>

              <!-- Add Row -->
              <button
                type="button"
                class="btn btn-outline-primary btn-sm mt-2"
                (click)="addItem()"
              >
                ‚ûï Add More
              </button>
            </div>
          </div>

          <!-- Submit -->
          <div class="col-12 d-flex justify-content-center mt-4">
            <button
              class="btn btn-success px-5"
              [disabled]="productForm.invalid"
              (click)="onSubmit()"
            >
              Save Product
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
